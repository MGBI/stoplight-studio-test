openapi: 3.0.0
info:
  title: Instrukcja obsługi API w serwisie IMSiG.pl
  version: '1.0'
  x-logo:
    url: 'https://www.imsig.pl/layout/monitor_sadowy_i_gospodarczy.png'
    altText: iMSiG.pl
  description: |-
    # Ogólne informacje
    API oparte jest na protokole HTTP, a treść wszystkich żądań i odpowiedzi przekazywana
    jest w formie obiektów języka JavaScript (JSON).

    W nagłówku HTTP `Content-Type` każdego żądania API przesyłanego metodą POST
    i zawierającego w treści obiekt JSON należy ustawić wartość `application/json`.

    W żądaniach API przesyłanych metodą GET parametry należy umieścić w query stringu.

    Każda metoda API może zwrócić jeden z kilku możliwych kodów odpowiedzi HTTP.
    Nagłówki i parametry odpowiedzi opisane poniżej dla każdej z metod zwracane są tylko
    dla kodu 200 (OK).

    # Autentykacja
    <SecurityDefinitions />
  contact:
    name: MGBI sp. z o.o.
    url: 'https://www.mgbi.pl'
    email: info@mgbi.pl

tags:
  - name: documents
    x-displayName: Dokumenty
    description: |-
      Interfejs programistyczny RDF dostępny w serwisie iMSiG.pl umożliwia wyszukiwanie
      i pobieranie dokumentów złożonych w Repozytorium Dokumentów Finansowych Krajowego
      Rejestru Sądowego.

      ## Źródło danych
      Począwszy od 15 marca 2018 r. każdy ma dostęp przez Internet do składanych przez
      podmioty gospodarcze dokumentów finansowych. Ta funkcjonalność dostępna jest
      bez posiadania konta użytkownika ani logowania na konto w wyszukiwarce na
      [stronie Ministerstwa Sprawiedliwości](https://ekrs.ms.gov.pl/rdf/pd/search_df).
      Wystarczy podać numer KRS, aby wyszukać dokumenty przypisane do podmiotu z tym numerem.

      ## Masowy dostęp
      Wyszukiwarka dokumentów złożonych w RDF nie jest przeznaczona do masowego dostępu do
      dokumentów. Wyszukiwanie jest zabezpieczone przed działaniem robotów pobierających
      dokumenty mechanizmem reCAPTCHA v3. Co więcej, część dokumentów udostępniana jest w formie
      plików XML z podpisem cyfrowym, co uniemożliwia ich odczyt w popularnych programach.

      Nasz interfejs programistyczny umożliwia masowe pobieranie dokumentów bez opóźnień
      związanych z wyszukiwaniem oraz bez problemów, które nierzadko występują przy pobieraniu
      pojedynczych plików. Wszystkie udostępniane przez nas dokumenty są gotowe do
      odczytu w popularnych programach.

      ## Podgląd dokumentów
      Dla wszystkich dokumentów złożonych w RDF w formacie innym niż PDF udostępniamy
      dodatkową opcję podglądu takiego dokumentu po konwersji do formatu PDF. Dotyczy to
      również sprawozdań finansowych sporządzonych w formacie XML, które w surowej postaci
      nie są czytelne dla odbiorcy. Dla tych sprawozdań udostępniamy ujednolicony oraz
      łatwy w użytkowaniu podgląd w formacie HTML oraz PDF.

      Aby sprawdzić opcje podglądu dokumentów, skorzystaj z [wyszukiwarki dokumentów](
      https://www.imsig.pl/sprawozdania-finansowe).

  - name: financial_data
    x-displayName: Dane finansowe
    description: |-
      Interfejs programistyczny RDF dostępny w serwisie iMSiG.pl umożliwia pobieranie
      przetworzonych danych finansowych ze sprawozdań złożonych w Repozytorium Dokumentów
      Finansowych Krajowego Rejestru Sądowego.

      ## Źródło danych
      Począwszy od 1 października 2018 r. sprawozdania finansowe podmiotów prowadzących
      księgi rachunkowe muszą być sporządzone w ustrukturyzowanym logicznie formacie
      XML (*Extensible Markup Format*). Struktury logiczne i format e-sprawozdań został
      określony i udostępnionych w Biuletynie Informacji Publicznej na
      [stronie internetowej Ministerstwa Finansów](
      https://www.gov.pl/web/kas/struktury-e-sprawozdan).

      Sprawozdania finansowe sporządzone w formacie XML nie są czytelne dla odbiorcy – 
      są one przygotowywane oraz odczytywane przez dedykowane oprogramowanie. Aby podejrzeć
      tak przygotowane sprawozdanie, skorzystaj z [wyszukiwarki dokumentów](
      https://www.imsig.pl/sprawozdania-finansowe).

      ## Struktury logiczne sprawozdań w XML
      Aby przygotować albo przetworzyć sprawozdaniu finansowe, należy wziąć pod uwagę 
      zastosowany rodzaj struktury logicznej, który zależy od typu podmiotu. Inną formę mają
      sprawozdania przygotowane dla jednostek mikro, inną dla jednostek małych, jednostek
      pożytku publicznego, domów maklerskich czy banków. Dodatkowo struktury logiczne
      sprawozdań finansowych są obecnie dostępne są w dwóch wersjach: 1-0 oraz 1-2.

      Wszystkie rodzaje struktur w obydwu wersjach są obsługiwane przez nasze oprogramowanie,
      co zapewnia pełną dostępność danych.

      ## Sprawozdania zgodne z MSR oraz MSSF
      Polskie spółki kapitałowe, co do zasady, sporządzają sprawozdania finansowe zgodnie
      z ustawą o rachunkowości. Ustawa dopuszcza, bądź wręcz czasem nakłada obowiązek,
      sporządzania sprawozdań zgodnych z Międzynarodowymi Standardami Rachunkowości (MSR)
      i Międzynarodowymi Standardami Sprawozdawczości Finansowej (MSSF).

      Takie sprawozdania występują w dowolnym nieustrukturyzowanym formacie, najczęściej
      jest to PDF (*Portable Document Format*). Oznacza to konieczność na wpół automatycznego
      przetwarzania dokumentów, który to proces nadzorowany jest przez naszego wykwalifikowanego
      pracownika.

      ## Weryfikacja danych
      Ze względu na mnogość rodzajów struktur sprawozdań, odczytywanie danych finansowych
      dla każdego typu podmiotu jest utrudnione. Dodatkowo, część dokumentów została wyeksportowana
      z programu księgowego z błędami. Nasze oprogramowanie naprawia uszkodzone struktury,
      aby odczytać dane z prawie każdego dokumentu.

      Oprócz błędów związanych z formatem danych, przy przetwarzaniu sprawozdań napotkamy
      na błędy wynikające z pomyłki człowieka. Należy do nich między innymi niepoprawne
      wskazanie rzędu wielkości do kwot występujących w sprawozdaniu - struktura pliku nie
      wskazuje, że zostało ono przygotowane w tysiącach a po ręcznej weryfikacji widać,
      że wartości występujące w sprawozdaniu powinny być interpretowane jako tysiące.
      Ma również miejsce sytuacja odwrotna, gdzie struktura pliku wskazuje na przygotowanie
      sprawozdania w tysiącach, co nie jest zgodne z rzeczywistością.
      Tego typu błędy są ręcznie poprawiane przez naszych pracowników.

      Zarówno dla dokumentów w formacie PDF jak i XML mogą pojawić się korekty. Nasze
      oprogramowanie uwzględnia aktualne zmiany i udostępniane przez nas dane zawsze
      pochodzą z najnowszej wersji sprawozdania finansowego.

  - name: announcements
    x-displayName: Ogłoszenia
    description: Dostęp do informacji z ogłoszeń opublikowanych w MSiG.
  - name: types
    x-displayName: Typy
    description: Złożone typy danych.

x-tagGroups:
  - name: KRS RDF API
    tags:
      - documents
      - financial_data
  - name: MSiG API
    tags:
      - announcements

paths:
  /v1/rdf/documents/:
    get:
      $ref: krs_rdf/paths/get-documents.yaml
  /v1/rdf/financialData/:
    get:
      $ref: krs_rdf/paths/get-financial-data.yaml
  /v1/upadlosci/announcements/:
    get:
      $ref: msig/paths/get-announcements.yaml
  /v1/upadlosci/checkNumbers/:
    post:
      $ref: msig/paths/check-numbers.yaml

components:
  securitySchemes:
    api_key:
      name: Authorization
      type: apiKey
      in: header
      description: |-
        Do uwierzytelniania użytkowników API wykorzystywany jest klucz użytkownika
        przekazywany w nagłówku HTTP `Authorization` przy wywoływaniu poszczególnych metod.
