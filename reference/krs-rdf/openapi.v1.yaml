openapi: 3.0.0
info:
  title: Instrukcja obsługi API w serwisie IMSiG.pl
  version: '1.0'
  x-logo:
    url: 'https://www.imsig.pl/layout/monitor_sadowy_i_gospodarczy.png'
    altText: iMSiG.pl
  description: |-
    # Ogólne informacje
    API oparte jest na protokole HTTP, a treść wszystkich żądań i odpowiedzi przekazywana
    jest w formie obiektów języka JavaScript (JSON).

    W nagłówku HTTP `Content-Type` każdego żądania API przesyłanego metodą POST
    i zawierającego w treści obiekt JSON należy ustawić wartość `application/json`.

    W żądaniach API przesyłanych metodą GET parametry należy umieścić w query stringu.

    Każda metoda API może zwrócić jeden z kilku możliwych kodów odpowiedzi HTTP.
    Nagłówki i parametry odpowiedzi opisane poniżej dla każdej z metod zwracane są tylko
    dla kodu 200 (OK).

    # Autentykacja
    <SecurityDefinitions />
  contact:
    name: MGBI sp. z o.o.
    url: 'https://www.mgbi.pl'
    email: info@mgbi.pl

tags:
  - name: documents
    x-displayName: Dokumenty
    description: |-
      Interfejs programistyczny RDF dostępny w serwisie iMSiG.pl umożliwia wyszukiwanie
      i pobieranie dokumentów złożonych w Repozytorium Dokumentów Finansowych Krajowego
      Rejestru Sądowego.

      ## Źródło danych
      Począwszy od 15 marca 2018 r. każdy ma dostęp przez Internet do składanych przez
      podmioty gospodarcze dokumentów finansowych. Ta funkcjonalność dostępna jest
      bez posiadania konta użytkownika ani logowania na konto w wyszukiwarce na
      [stronie Ministerstwa Sprawiedliwości](https://ekrs.ms.gov.pl/rdf/pd/search_df).
      Wystarczy podać numer KRS, aby wyszukać dokumenty przypisane do podmiotu z tym numerem.

      ## Masowy dostęp
      Wyszukiwarka dokumentów złożonych w RDF nie jest przeznaczona do masowego dostępu do
      dokumentów. Wyszukiwanie jest zabezpieczone przed działaniem robotów pobierających
      dokumenty mechanizmem reCAPTCHA v3. Co więcej, część dokumentów udostępniana jest w formie
      plików XML z podpisem cyfrowym, co uniemożliwia ich odczyt w popularnych programach.

      Nasz interfejs programistyczny umożliwia masowe pobieranie dokumentów bez opóźnień
      związanych z wyszukiwaniem oraz bez problemów, które nierzadko występują przy pobieraniu
      pojedynczych plików. Wszystkie udostępniane przez nas dokumenty są gotowe do
      odczytu w popularnych programach.

      ## Podgląd dokumentów
      Dla wszystkich dokumentów złożonych w RDF w formacie innym niż PDF udostępniamy
      dodatkową opcję podglądu takiego dokumentu po konwersji do formatu PDF. Dotyczy to
      również sprawozdań finansowych sporządzonych w formacie XML, które w surowej postaci
      nie są czytelne dla odbiorcy. Dla tych sprawozdań udostępniamy ujednolicony oraz
      łatwy w użytkowaniu podgląd w formacie HTML oraz PDF.

      Aby sprawdzić opcje podglądu dokumentów, skorzystaj z [wyszukiwarki dokumentów](
      https://www.imsig.pl/sprawozdania-finansowe).

  - name: financial_data
    x-displayName: Dane finansowe
    description: |-
      Interfejs programistyczny RDF dostępny w serwisie iMSiG.pl umożliwia pobieranie
      przetworzonych danych finansowych ze sprawozdań złożonych w Repozytorium Dokumentów
      Finansowych Krajowego Rejestru Sądowego.

      ## Źródło danych
      Począwszy od 1 października 2018 r. sprawozdania finansowe podmiotów prowadzących
      księgi rachunkowe muszą być sporządzone w ustrukturyzowanym logicznie formacie
      XML (*Extensible Markup Format*). Struktury logiczne i format e-sprawozdań został
      określony i udostępnionych w Biuletynie Informacji Publicznej na
      [stronie internetowej Ministerstwa Finansów](
      https://www.gov.pl/web/kas/struktury-e-sprawozdan).

      Sprawozdania finansowe sporządzone w formacie XML nie są czytelne dla odbiorcy – 
      są one przygotowywane oraz odczytywane przez dedykowane oprogramowanie. Aby podejrzeć
      tak przygotowane sprawozdanie, skorzystaj z [wyszukiwarki dokumentów](
      https://www.imsig.pl/sprawozdania-finansowe).

      ## Struktury logiczne sprawozdań w XML
      Aby przygotować albo przetworzyć sprawozdaniu finansowe, należy wziąć pod uwagę 
      zastosowany rodzaj struktury logicznej, który zależy od typu podmiotu. Inną formę mają
      sprawozdania przygotowane dla jednostek mikro, inną dla jednostek małych, jednostek
      pożytku publicznego, domów maklerskich czy banków. Dodatkowo struktury logiczne
      sprawozdań finansowych są obecnie dostępne są w dwóch wersjach: 1-0 oraz 1-2.

      Wszystkie rodzaje struktur w obydwu wersjach są obsługiwane przez nasze oprogramowanie,
      co zapewnia pełną dostępność danych.

      ## Sprawozdania zgodne z MSR oraz MSSF
      Polskie spółki kapitałowe, co do zasady, sporządzają sprawozdania finansowe zgodnie
      z ustawą o rachunkowości. Ustawa dopuszcza, bądź wręcz czasem nakłada obowiązek,
      sporządzania sprawozdań zgodnych z Międzynarodowymi Standardami Rachunkowości (MSR)
      i Międzynarodowymi Standardami Sprawozdawczości Finansowej (MSSF).

      Takie sprawozdania występują w dowolnym nieustrukturyzowanym formacie, najczęściej
      jest to PDF (*Portable Document Format*). Oznacza to konieczność na wpół automatycznego
      przetwarzania dokumentów, który to proces nadzorowany jest przez naszego wykwalifikowanego
      pracownika.

      ## Weryfikacja danych
      Ze względu na mnogość rodzajów struktur sprawozdań, odczytywanie danych finansowych
      dla każdego typu podmiotu jest utrudnione. Dodatkowo, część dokumentów została wyeksportowana
      z programu księgowego z błędami. Nasze oprogramowanie naprawia uszkodzone struktury,
      aby odczytać dane z prawie każdego dokumentu.

      Oprócz błędów związanych z formatem danych, przy przetwarzaniu sprawozdań napotkamy
      na błędy wynikające z pomyłki człowieka. Należy do nich między innymi niepoprawne
      wskazanie rzędu wielkości do kwot występujących w sprawozdaniu - struktura pliku nie
      wskazuje, że zostało ono przygotowane w tysiącach a po ręcznej weryfikacji widać,
      że wartości występujące w sprawozdaniu powinny być interpretowane jako tysiące.
      Ma również miejsce sytuacja odwrotna, gdzie struktura pliku wskazuje na przygotowanie
      sprawozdania w tysiącach, co nie jest zgodne z rzeczywistością.
      Tego typu błędy są ręcznie poprawiane przez naszych pracowników.

      Zarówno dla dokumentów w formacie PDF jak i XML mogą pojawić się korekty. Nasze
      oprogramowanie uwzględnia aktualne zmiany i udostępniane przez nas dane zawsze
      pochodzą z najnowszej wersji sprawozdania finansowego.

  - name: announcements
    x-displayName: Ogłoszenia
    description: Dostęp do informacji z ogłoszeń opublikowanych w MSiG.
  - name: types
    x-displayName: Typy
    description: Złożone typy danych.

x-tagGroups:
  - name: KRS RDF API
    tags:
      - documents
      - financial_data
  - name: MSiG API
    tags:
      - announcements

paths:
  /v1/rdf/documents/:
    get:
      summary: ''
      operationId: get-documents
      tags:
        - documents
      security:
        - api_key: []
      description: Pobiera informacje o dokumentach złożonych do Repozytorium Dokumentów Finansowych KRS spełniających podane kryteria.
      parameters:
        - schema:
            type: string
            example: '0000028860'
            pattern: "^\\d{10}$"
            minLength: 10
            maxLength: 10
          in: query
          name: krs
          description: 'Numer KRS podmiotu, którego dotyczy dokument'
        - schema:
            $ref: '#/components/schemas/document_type'
          in: query
          name: type
        - schema:
            type: integer
            example: 2019
          in: query
          name: period_year
          description: 'Rok obrachunkowy, którego dotyczy dokument'
        - schema:
            type: string
            format: date
            example: '2020-01-01'
          in: query
          name: filing_date_from
          description: Początek zakresu dla daty publikacji dokumentu w RDF
        - schema:
            type: string
            format: date
            example: '2020-12-31'
          in: query
          name: filing_date_to
          description: Koniec zakresu dla daty publikacji dokumentu w RDF
        - schema:
            type: string
            format: date
            example: '2020-07-01'
          in: query
          name: crawling_date_from
          description: Początek zakresu dla daty pobrania dokumentu z RDF
        - schema:
            type: string
            format: date
            example: '2020-07-31'
          in: query
          name: crawling_date_to
          description: Koniec zakresu dla daty pobrania dokumentu z RDF
      responses:
        '200':
          description: Poprawne wyszukiwanie dokumentów
          content:
            application/json:
              schema:
                type: array
                minItems: 0
                maxItems: 100
                uniqueItems: true
                description: |-
                  Lista dokumentów spełniających kryteria
                  określone w parametrach metody, posortowanych malejąco według daty publikacji w RDF.
                  W przypadku, gdy żaden dokument nie spełnia podanych kryteriów, zwracana jest pusta
                  lista. W przypadku, gdy liczba dokumentów spełniających kryteria jest większa niż 100,
                  lista zawiera 100 pierwszych dokumentów.
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: Unikalny identyfikator dokumentu (wewnętrzy identyfikator dokumentu w RDF)
                      example: 2047606
                      format: int32
                    krs:
                      type: string
                      pattern: "^\\d{10}$"
                      minLength: 10
                      maxLength: 10
                      description: 'Numer KRS podmiotu, którego dotyczy dokument'
                      example: '0000028860'
                    type:
                      $ref: '#/components/schemas/document_type'
                    period_from:
                      type: string
                      format: date
                      example: '2019-01-01'
                      description: 'Data początkowa okresu, którego dotyczy dokument'
                    period_to:
                      type: string
                      example: '2019-12-31'
                      format: date
                      description: 'Data końcowa okresu, którego dotyczy dokument'
                    period_year:
                      type: integer
                      example: 2019
                      format: int32
                      description: 'Rok obrachunkowy, którego dotyczy dokument'
                    preparation_date:
                      type: string
                      format: date
                      example: '2020-06-30'
                      description: Data sporządzenia dokumentu
                    filing_date:
                      type: string
                      format: date
                      example: '2020-07-01'
                      description: Data publikacji dokumentu w RDF
                    crawling_date:
                      type: string
                      format: date
                      example: '2020-07-15'
                      description: Data pobrania dokumentu z RDF
                    is_correction:
                      type: boolean
                      example: false
                      description: 'Informacja, czy dokument jest korektą'
                    ias_standard:
                      type: boolean
                      example: false
                      description: 'Informacja, czy dokument został sporządzony zgodnie z Międzynarodowymi Standardami Rachunkowości'
                    language:
                      $ref: '#/components/schemas/language'
                    submission_id:
                      type: integer
                      format: int32
                      description: Wewnętrzny identyfikator zgłoszenia w RDF
                      example: 845399
                    file_root:
                      type: string
                      description: Nazwa pliku dokumentu bez rozszerzenia (w języku angielskim)
                      example: 0000028860_2018_financial_statement_2047606
                      pattern: "^\\d{10}_\\d{4}_[a-z_]+_\\d+$"
                    file_root_pl:
                      type: string
                      pattern: "^\\d{10}_\\d{4}_[a-z_]+_\\d+$"
                      example: 0000028860_2018_sprawozdanie_finansowe_2047606
                      description: Nazwa pliku dokumentu bez rozszerzenia (w języku polskim)
                    file_format:
                      type: string
                      example: pdf
                      description: Format pliku
                    file_content_type:
                      $ref: '#/components/schemas/mime_type'
                    download_url:
                      type: string
                      format: uri
                      description: Bezpośredni adres URL pliku z treścią oryginalnego dokumentu
                      example: 'https://rdf-api.imsig.pl/v1/documents/2047606/download'
                    pdf_preview_url:
                      type: string
                      format: uri
                      description: Bezpośredni adres URL pliku z dokumentem w postaci przetworzonej do formatu PDF (tylko dla dokumentów w formacie XML)
                      example: 'https://rdf-api.imsig.pl/v1/documents/2047606/download?format=pdf'
                    html_preview_url:
                      type: string
                      format: uri
                      example: 'https://rdf-api.imsig.pl/v1/documents/2047606/download?format=html'
                      description: Bezpośredni adres URL pliku z dokumentem w postaci przetworzonej do formatu HTML (tylko dla dokumentów w formacie XML)
                  required:
                    - id
                    - krs
                    - type
                    - period_from
                    - period_to
                    - period_year
                    - filing_date
                    - crawling_date
                    - is_correction
                    - ias_standard
              examples:
                example-1:
                  value:
                    - id: 2047606
                      krs: '0000028860'
                      type: financial_statement
                      period_from: '2018-01-01'
                      period_to: '2018-12-31'
                      period_year: 2018
                      preparation_date: '2019-03-29'
                      filing_date: '2019-06-27'
                      crawling_date: '2019-08-14'
                      is_correction: false
                      ias_standard: true
                      language: pl
                      submission_id: 845399
                      file_root: 0000028860_2018_financial_statement_2047606
                      file_root_pl: 0000028860_2018_sprawozdanie_finansowe_2047606
                      file_format: pdf
                      file_content_type: application/pdf
                      download_url: 'http://rdf-api.imsig.pl/v1/documents/2047606/download/'
                      pdf_preview_url: 'http://rdf-api.imsig.pl/v1/documents/2047606/preview/?format=pdf'
        '400':
          $ref: '#/components/responses/bad_request'
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '429':
          $ref: '#/components/responses/too_many_requests'
      x-code-samples:
        - lang: Shell
          source: |-
            # Wyszukaj dokumenty dla podmiotu z numerem KRS `0000028860`
            curl https://api.imsig.pl/v1/rdf/documents?krs=0000028860 --header \"Authorization: aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee\"

  /v1/rdf/financialData/:
    get:
      summary: ''
      operationId: get-financial-data
      tags:
        - financial_data
      security:
        - api_key: []
      description: Pobiera przetworzone dane finansowe ze sprawozdań złożonych do Repozytorium Dokumentów Finansowych KRS spełniających podane kryteria.
      parameters:
        - schema:
            type: string
            example: '0000019193'
            pattern: "^\\d{10}$"
            minLength: 10
            maxLength: 10
          in: query
          name: krs
          description: 'Numer KRS podmiotu, którego dotyczy sprawozdanie'
        - schema:
            $ref: '#/components/schemas/document_type'
          in: query
          name: type
        - schema:
            type: integer
            example: 2018
          in: query
          name: period_year
          description: 'Rok obrachunkowy, którego dotyczy sprawozdanie'
        - schema:
            type: string
            format: date
            example: '2019-01-01'
          in: query
          name: filing_date_from
          description: Początek zakresu dla daty publikacji sprawozdania w RDF
        - schema:
            type: string
            format: date
            example: '2019-12-31'
          in: query
          name: filing_date_to
          description: Koniec zakresu dla daty publikacji sprawozdania w RDF
        - schema:
            type: string
            format: date
            example: '2020-07-01'
          in: query
          name: crawling_date_from
          description: Początek zakresu dla daty pobrania dokumentu z RDF
        - schema:
            type: string
            format: date
            example: '2020-07-31'
          in: query
          name: crawling_date_to
          description: Koniec zakresu dla daty pobrania dokumentu z RDF
        - schema:
            type: boolean
            example: false
          in: query
          name: consolidated
          description: 'Informacja, czy sprawozdanie jest skonsolidowane'
        - schema:
            type: boolean
            example: false
          in: query
          name: ias_standard
          description: 'Informacja, czy sprawozdanie zostało sporządzone zgodnie z Międzynarodowymi Standardami Rachunkowości'
      responses:
        '200':
          description: Poprawne wyszukiwanie danych finansowych
          content:
            application/json:
              schema:
                type: array
                minItems: 0
                maxItems: 100
                uniqueItems: true
                description: |-
                  Lista danych finansowych ze sprawozdań spełniających kryteria określone
                  w parametrach metody, posortowanych malejąco według daty publikacji w RDF.
                  W przypadku, gdy żadne sprawozdanie nie spełnia podanych kryteriów, zwracana
                  jest pusta lista. W przypadku, gdy liczba sprawozdań spełniających kryteria
                  jest większa niż 100, lista zawiera dane finansowe ze 100 pierwszych dokumentów.
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      description: Unikalny identyfikator sprawozdania (wewnętrzy identyfikator dokumentu w RDF)
                      example: 2520543
                      format: int32
                    krs:
                      type: string
                      pattern: "^\\d{10}$"
                      minLength: 10
                      maxLength: 10
                      example: '0000019193'
                      description: 'Numer KRS podmiotu, którego dotyczy sprawozdanie'
                    period_from:
                      type: string
                      format: date
                      example: '2018-01-01'
                      description: 'Data początkowa okresu, którego dotyczy sprawozdanie'
                    period_to:
                      type: string
                      example: '2018-12-31'
                      format: date
                      description: 'Data końcowa okresu, którego dotyczy sprawozdanie'
                    period_year:
                      type: integer
                      example: 2018
                      format: int32
                      description: 'Rok obrachunkowy, którego dotyczy sprawozdanie'
                    preparation_date:
                      type: string
                      format: date
                      example: '2020-04-12'
                      description: Data sporządzenia sprawozdania
                    filing_date:
                      type: string
                      format: date
                      example: '2020-07-19'
                      description: Data publikacji sprawozdania w RDF
                    crawling_date:
                      type: string
                      format: date
                      example: '2020-07-24'
                      description: Data pobrania sprawozdania z RDF
                    consolidated:
                      type: boolean
                      example: true
                      description: 'Informacja, czy sprawozdanie jest skonsolidowane'
                    ias_standard:
                      type: boolean
                      example: false
                      description: 'Informacja, czy sprawozdanie zostało sporządzone zgodnie z Międzynarodowymi Standardami Rachunkowości'

                    bs_lae_nc_cfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '10150715600.00'
                      description: Kapitał (fundusz) podstawowy - kwota na dzień kończący bieżący rok obrotowy
                    bs_lae_nc_pfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '10150715600.00'
                      description: Kapitał (fundusz) podstawowy - kwota na dzień kończący poprzedni rok obrotowy
                    bs_lae_nc_cpfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '10150715600.00'
                      description: Kapitał (fundusz) podstawowy - przekształcone dane porównawcze za poprzedni rok obrotowy

                    bs_a_ta_cfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '26227994995.11'
                      description: Aktywa razem - kwota na dzień kończący bieżący rok obrotowy
                    bs_a_ta_pfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '25540926976.86'
                      description: Aktywa razem - kwota na dzień kończący poprzedni rok obrotowy
                    bs_a_ta_cpfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '25573272324.98'
                      description: Aktywa razem - przekształcone dane porównawcze za poprzedni rok obrotowy

                    bs_lae_e_cfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '10834213197.71'
                      description: Kapitał (fundusz) własny - kwota na dzień kończący bieżący rok obrotowy
                    bs_lae_e_pfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '10400343189.57'
                      description: Kapitał (fundusz) własny - kwota na dzień kończący poprzedni rok obrotowy
                    bs_lae_e_cpfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '10362941097.49'
                      description: Kapitał (fundusz) własny - przekształcone dane porównawcze za poprzedni rok obrotowy

                    pala_nrfs_cfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '9318533736.56'
                      description: Przychody netto ze sprzedaży - kwota na dzień kończący bieżący rok obrotowy
                    pala_nrfs_pfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '8501384278.96'
                      description: Przychody netto ze sprzedaży - kwota na dzień kończący poprzedni rok obrotowy
                    pala_nrfs_cpfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '8588730876.40'
                      description: Przychody netto ze sprzedaży - przekształcone dane porównawcze za poprzedni rok obrotowy
 
                    pala_npl_cfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '479809229.39'
                      description: Zysk (strata) netto - kwota na dzień kończący bieżący rok obrotowy
                    pala_npl_pfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '652934002.40'
                      description: Zysk (strata) netto - kwota na dzień kończący poprzedni rok obrotowy
                    pala_npl_cpfy:
                      type: string
                      pattern: "\\d+\\.\\d{2}"
                      example: '653871907.56'
                      description: Zysk (strata) netto - przekształcone dane porównawcze za poprzedni rok obrotowy

                  required:
                    - id
                    - krs
                    - period_from
                    - period_to
                    - period_year
                    - preparation_date
                    - filing_date
                    - crawling_date
                    - consolidated
                    - ias_standard
              examples:
                example-1:
                  value:
                    - id: 2520543
                      krs: '0000019193'
                      period_from: '2018-01-01'
                      period_to: '2018-12-31'
                      period_year: 2018
                      preparation_date: '2019-04-12'
                      filing_date: '2019-07-19'
                      crawling_date: '2019-07-24'
                      consolidated: true
                      ias_standard: false
                      bs_lae_nc_cfy: '10150715600.00'
                      bs_lae_nc_pfy: '10150715600.00'
                      bs_lae_nc_cpfy: '10150715600.00'
                      bs_a_ta_cfy: '26227994995.11'
                      bs_a_ta_pfy: '25540926976.86'
                      bs_a_ta_cpfy: '25573272324.98'
                      bs_lae_e_cfy: '10834213197.71'
                      bs_lae_e_pfy: '10400343189.57'
                      bs_lae_e_cpfy: '10362941097.49'
                      pala_nrfs_cfy: '9318533736.56'
                      pala_nrfs_pfy: '8501384278.96'
                      pala_nrfs_cpfy: '8588730876.40'
                      pala_npl_cfy: '479809229.39'
                      pala_npl_pfy: '652934002.40'
                      pala_npl_cpfy: '653871907.56'
        '400':
          $ref: '#/components/responses/bad_request'
        '401':
          $ref: '#/components/responses/unauthorized'
        '403':
          $ref: '#/components/responses/forbidden'
        '429':
          $ref: '#/components/responses/too_many_requests'
      x-code-samples:
        - lang: Shell
          source: |-
            # Wyszukaj dane finansowe ze sprawozdania dla podmiotu z numerem KRS `0000019193`
            curl https://api.imsig.pl/v1/rdf/financialData?krs=0000019193 --header \"Authorization: aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee\"

  /v1/upadlosci/announcements/:
    get:
      summary: ''
      operationId: get-announcements
      tags:
        - announcements
      security:
        - api_key: []
      description: 'Pobiera treść i wyodrębnione informacje z ogłoszeń tekstowych opublikowanych we wszystkich rozdziałach MSiG poza rozdziałem *XV. Wpisy do krajowego rejestru sądowego*.'
      parameters:
        - schema:
            $ref: '#/components/schemas/msig_signature'
          in: query
          name: id
          description: Sygnatura ogłoszenia w MSiG
        - schema:
            type: string
            format: date
            example: '2019-01-01'
          in: query
          name: date_from
          description: Początek zakresu dla daty publikacji ogłoszenia w MSiG
        - schema:
            type: string
            format: date
            example: '2019-12-31'
          in: query
          name: date_to
          description: Koniec zakresu dla daty publikacji ogłoszenia w MSiG
        - schema:
            $ref: '#/components/schemas/msig_chapter'
          in: query
          name: msig_chapter
        - schema:
            $ref: '#/components/schemas/msig_section'
          in: query
          name: msig_section
        - schema:
            $ref: '#/components/schemas/nip'
          in: query
          name: nip
          description: 'Numer NIP podmiotu, którego dotyczy ogłoszenie'
        - schema:
            $ref: '#/components/schemas/regon'
          in: query
          name: regon
          description: 'Numer REGON podmiotu, którego dotyczy ogłoszenie'
        - schema:
            $ref: '#/components/schemas/krs'
          in: query
          name: krs
          description: 'Numer KRS podmiotu, którego dotyczy sprawozdanie'
        - schema:
            type: string
          in: query
          name: commissioner_name
          description: Imię i nazwisko sędziego komisarza wyznaczonego w postępowaniu
        - schema:
            type: string
          in: query
          name: administrator_name
          description: Imię i nazwisko nadzorcy wyznaczonego w postępowaniu
        - schema:
            type: string
            enum:
              - entity
              - proceeding
              - order
              - msig_entry
              - content
          in: query
          name: projection
          description: |-
            Lista zwracanych grup informacji

            <details>
              <summary>Pokaż możliwe opcje</summary>

              | Identyfikator | Grupa informacji |
              |-|-|
              | `"entity"` | Lista podmiotów, których dotyczy ogłoszenie |
              | `"proceeding"` | Informacje o postępowaniu |
              | `"order"` | Informacje o postanowieniu, którego dotyczy ogłoszenie |
              | `"msig_entry"` | Informacje dotyczące numeru MSiG, z którego pochodzi ogłoszenie |
              | `"content"` | Nieprzetworzona treść ogłoszenia |

            </details>
      responses:
        '200':
          description: Poprawne wyszukiwanie ogłoszeń
          content:
            application/json:
              schema:
                type: array
                description: 'Lista ogłoszeń spełniających kryteria określone w parametrach metody, posortowanych według daty publikacji w MSiG.'
                items:
                  type: object
                  properties:
                    id:
                      type: string
                      description: Unikalny identyfikator ogłoszenia
                    entity:
                      type: array
                      description: 'Lista podmiotów, których dotyczy ogłoszenie'
                      items:
                        type: object
                        properties:
                          info:
                            type: object
                            description: Podstawowe dane podmiotu
                            required:
                              - cleaned_name
                              - legal_form
                              - ownership_type
                              - primary_business
                              - commencement_date
                            properties:
                              cleaned_name:
                                type: string
                                description: Nazwa podmiotu
                              legal_form:
                                type: string
                                description: Forma prawna
                              ownership_type:
                                type: string
                                description: Forma własności
                              primary_business:
                                type: string
                                description: Przeważająca działalność gospodarcza (kod PKD)
                              commencement_date:
                                type: string
                                description: Data rozpoczęcia działalności
                          numbers:
                            type: object
                            description: Numery rejestrowe podmiotu
                            required:
                              - nip
                              - regon
                              - krs
                            properties:
                              nip:
                                $ref: '#/components/schemas/nip'
                              regon:
                                $ref: '#/components/schemas/regon'
                              krs:
                                $ref: '#/components/schemas/krs'
                          address:
                            type: object
                            description: Adres pocztowy siedziby podmiotu lub miejsca zamieszkania
                            required:
                              - state
                              - powiat
                              - gmina
                              - town
                              - street
                              - house_number
                              - zip_code
                              - post_office
                            properties:
                              state:
                                type: string
                                description: Województwo
                              powiat:
                                type: string
                                description: Powiat
                              gmina:
                                type: string
                                description: Gmina
                              town:
                                type: string
                                description: Miejscowość
                              street:
                                type: string
                                description: Ulica
                              house_number:
                                type: string
                                description: Numer nieruchomości
                              flat_number:
                                type: string
                                description: Numer lokalu
                              zip_code:
                                type: string
                                description: Kod pocztowy
                              post_office:
                                type: string
                                description: Poczta
                        required:
                          - info
                          - numbers
                          - address
                    proceeding:
                      type: object
                      description: Informacje o postępowaniu
                      properties:
                        court_name:
                          type: string
                          description: Nazwa sądu
                        court_department:
                          type: string
                          description: Nazwa wydziału
                        signatures:
                          type: string
                          description: Sygnatury postępowania
                        commissioner_name:
                          type: string
                          description: Imię i nazwisko sędziego komisarza
                        commissioner_deputy_name:
                          type: string
                          description: Imię i nazwisko zastępcy sędziego komisarza
                        administrator_name:
                          type: string
                          description: Imię i nazwisko nadzorcy wyznaczonego w postępowaniu
                        administrator_function:
                          type: string
                          description: Funkcja nadzorcy
                          example: syndyk
                          enum:
                            - syndyk
                            - zarządca
                            - nadzorca sądowy
                        administrator_licence_number:
                          type: string
                          description: Numer licencji doradcy restrukturyzacyjnego nadzorcy w postępowaniu
                      required:
                        - court_name
                        - court_department
                        - signatures
                        - commissioner_name
                        - commissioner_deputy_name
                        - administrator_name
                        - administrator_function
                        - administrator_licence_number
                    order:
                      type: object
                      description: 'Informacje o postanowieniu, którego dotyczy ogłoszenie'
                      properties:
                        order_date:
                          type: string
                          description: Data wydania postanowienia
                          format: date
                        expiration_period:
                          type: integer
                          description: Okres do działania (w dniach)
                          format: int32
                        expiration_date:
                          type: string
                          format: date
                          description: Data końcowa okresu do działania
                      required:
                        - order_date
                        - expiration_period
                        - expiration_date
                    msig_entry:
                      type: object
                      description: 'Informacje dotyczące numeru MSiG, z którego pochodzi ogłoszenie'
                      properties:
                        chapter:
                          $ref: '#/components/schemas/msig_chapter'
                        section:
                          $ref: '#/components/schemas/msig_section'
                        signature:
                          $ref: '#/components/schemas/msig_signature'
                        issue_date:
                          type: string
                          format: date
                          description: Data publikacji ogłoszenia w MSiG
                        yearly_number:
                          type: integer
                          description: Numer wydania MSiG
                          format: int32
                        position_number:
                          type: integer
                          format: int32
                          description: Numer pozycji MSiG
                        url:
                          type: string
                          format: uri
                          description: Adres URL ogłoszenia w serwisie imsig.pl
                      required:
                        - chapter
                        - section
                        - signature
                        - issue_date
                        - yearly_number
                        - position_number
                        - url
                    content:
                      type: object
                      required:
                        - text
                        - html
                      description: Nieprzetworzona treść ogłoszenia
                      properties:
                        text:
                          type: string
                          description: Treść ogłoszenia w formacie tekstowym
                        html:
                          type: string
                          description: Treść ogłoszenia w formacie HTML
                  required:
                    - id
      x-code-samples:
        - lang: Shell
          source: |-
            # Wyszukaj ogłoszenia dla podmiotu z numerem KRS `0000136890`
            curl https://api.imsig.pl/v1/upadlosci/announcements?krs=0000136890 --header \"Authorization: aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee\"

  /v1/upadlosci/checkNumbers/:
    post:
      summary: ''
      operationId: check-numbers
      tags:
        - announcements
      security:
        - api_key: []
      description: 'Sprawdza, czy we wskazanym okresie pojawiły się ogłoszenia dotyczące podmiotów o przekazanych numerach rejestrowych.'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                date_from:
                  type: string
                  format: date
                  example: '2019-01-01'
                  description: Początek zakresu dla daty publikacji ogłoszenia w MSiG
                date_to:
                  type: string
                  format: date
                  example: '2019-12-31'
                  description: Koniec zakresu dla daty publikacji ogłoszenia w MSiG
                nip:
                  type: string
                  pattern: "^\\d{10}$"
                  minLength: 10
                  maxLength: 10
                  example: '9491827824'
                  description: 'Numer NIP podmiotu, którego dotyczy sprawozdanie'
                regon:
                  type: string
                  pattern: "^\\d{9}$"
                  minLength: 9
                  maxLength: 9
                  example: '152074271'
                  description: 'Numer REGON podmiotu, którego dotyczy ogłoszenie'
                krs:
                  type: string
                  pattern: "^\\d{10}$"
                  minLength: 10
                  maxLength: 10
                  example: '0000136890'
                  description: 'Numer KRS podmiotu, którego dotyczy ogłoszenie'
      responses:
        '200':
          description: Poprawne sprawdzenie ogłoszeń
          content:
            application/json:
              schema:
                type: object
                description: 'Cztery listy zawierające numery rejestrowe przekazane w parametrach żądania, dla których we wskazanym okresie pojawiły się ogłoszenia w MSiG.'
                properties:
                  nip:
                    type: array
                    description: 'Lista numerów NIP, dla których we wskazanym okresie pojawiły się ogłoszenia w MSiG.'
                    items:
                      $ref: '#/components/schemas/nip'
                  regon:
                    type: array
                    description: 'Lista numerów REGON, dla których we wskazanym okresie pojawiły się ogłoszenia w MSiG.'
                    items:
                      $ref: '#/components/schemas/regon'
                  krs:
                    type: array
                    description: 'Lista numerów KRS, dla których we wskazanym okresie pojawiły się ogłoszenia w MSiG.'
                    items:
                      $ref: '#/components/schemas/krs'
                required:
                  - nip
                  - regon
                  - krs
      x-code-samples:
        - lang: Shell
          source: |-
            # Sprawdź ogłoszenia dla podmiotu z numerem KRS `0000136890`
            curl https://api.imsig.pl/v1/upadlosci/checkNumbers --request POST --header \"Authorization: aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee\" --data '{"krs":["0000136890"]}'

components:
  #-------------------------------
  # Reusable schemas (data models)
  #-------------------------------
  schemas:
    nip:
      type: string
      pattern: "\\d{10}"
      minLength: 10
      maxLength: 10
      example: '9491827824'
      description: Numer NIP
    regon:
      type: string
      pattern: "\\d{9}"
      minLength: 9
      maxLength: 9
      example: '152074271'
      description: Numer REGON
    krs:
      type: string
      pattern: "\\d{10}"
      minLength: 10
      maxLength: 10
      example: '0000136890'
      description: Numer KRS
    msig_signature:
      type: string
      description: Sygnatura ogłoszenia w MSiG
    msig_chapter:
      type: integer
      example: 0
      enum:
        - 0
        - 1
      description: |-
        Rozdział MSiG

        <details>
          <summary>Pokaż możliwe opcje</summary>

          | Wartość | Nazwa rozdziału |
          |-|-|
          | `0` | Ogłoszenia wymagane przez prawo upadłościowe |
          | `1` | Ogłoszenia wymagane przez prawo restrukturyzacyjne |

        </details>
    msig_section:
      type: integer
      example: 1
      enum:
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
        - 8
        - 9
      description: |-
        Sekcja MSiG dla rozdziału `1`

        <details>
          <summary>Pokaż możliwe opcje</summary>

          | Wartość | Nazwa sekcji |
          |-|-|
          | `1` | Postanowienie o ogłoszeniu upadłości |
          | `2` | Obwieszczenie o zatwierdzeniu układu |
          | `3` | Ogłoszenie o sporządzeniu i przekazaniu sędziemu komisarzowi listy wierzytelności |
          | `4` | Ogłoszenie o możliwości przeglądania planu podziału |
          | `5` | Postanowienie o umorzeniu postępowania upadłościowego |
          | `6` | Postanowienie o zakończeniu postępowania upadłościowego |
          | `7` | Ogłoszenie o złożeniu oświadczenia o wszczęciu postępowania naprawczego |
          | `8` | Ogłoszenie o terminie rozprawy zatwierdzającej układ |
          | `9` | Inne |

        </details>
    document_type:
      type: string
      description: |-
          Identyfikator rodzaju dokumentu

          <details>
            <summary>Pokaż możliwe opcje</summary>

            | Identyfikator | Rodzaj dokumentu | Nazwa dokumentu |
            |-|-|-|
            | `"auditors_opinion"` | Opinia biegłego rewidenta / sprawozdanie z badania rocznego sprawozdania finansowego |  |
            | `"consolidated_auditors_opinion"` | Opinia biegłego rewidenta / sprawozdanie z badania skonsolidowanego rocznego sprawozdania finansowego grupy kapitałowej |  |
            | `"balance_sheet"` | Roczne sprawozdanie finansowe | Bilans |
            | `"footnotes"` | Roczne sprawozdanie finansowe | Informacja dodatkowa lub inny dokument z art. 48 ustawy o rachunkowości |
            | `"cash_flow_statement"` | Roczne sprawozdanie finansowe | Rachunek przepływów pieniężnych |
            | `"profit_and_loss_statement"` | Roczne sprawozdanie finansowe | Rachunek zysków i strat |
            | `"equity_statement"` | Roczne sprawozdanie finansowe | Zestawienie zmian w kapitale (funduszu) własnym |
            | `"financial_statement"` | Roczne sprawozdanie finansowe |  |
            | `"consolidated_footnotes"` | Skonsolidowane roczne sprawozdanie finansowe | Informacja dodatkowa lub inny dokument z art. 48 ustawy o rachunkowości |
            | `"consolidated_equity_statement"` | Skonsolidowane roczne sprawozdanie finansowe | Skonsolidowane zestawienie zmian w kapitale (funduszu) własnym |
            | `"consolidated_balance_sheet"` | Skonsolidowane roczne sprawozdanie finansowe | Skonsolidowany bilans |
            | `"consolidated_cash_flow_statement"` | Skonsolidowane roczne sprawozdanie finansowe | Skonsolidowany rachunek przepływów pieniężnych |
            | `"consolidated_profit_and_loss_statement"` | Skonsolidowane roczne sprawozdanie finansowe | Skonsolidowany rachunek zysków i strat |
            | `"consolidated_equity_statement"` | Skonsolidowane roczne sprawozdanie finansowe | Zestawienie zmian w kapitale (funduszu) własnym |
            | `"consolidated_financial_statement"` | Skonsolidowane roczne sprawozdanie finansowe |  |
            | `"activity_report"` | Sprawozdanie z działalności |  |
            | `"consolidated_and_parent_activity_report"` | Sprawozdanie z działalności jednostki dominującej oraz sprawozdanie z działalności grupy kapitałowej |  |
            | `"parent_activity_report"` | Sprawozdanie z działalności jednostki dominującej |  |
            | `"report_on_payments"` | Sprawozdanie z płatności na rzecz administracji publicznej |  |
            | `"consolidated_report_on_payments"` | Skonsolidowane sprawozdanie z płatności na rzecz administracji publicznej |  |
            | `"resolution_on_approval"` | Uchwała lub postanowienie o zatwierdzeniu rocznego sprawozdania finansowego |  |
            | `"consolidated_resolution_on_approval"` | Uchwała lub postanowienie o zatwierdzeniu skonsolidowanego rocznego sprawozdania finansowego |  |
            | `"resolution_on_profit_distribution"` | Uchwała o podziale zysku bądź pokryciu straty |  |

          </details>
      # TODO hide enums from documentation
      enum:
        - auditors_opinion
        - consolidated_auditors_opinion
        - balance_sheet
        - footnotes
        - cash_flow_statement
        - profit_and_loss_statement
        - equity_statement
        - financial_statement
        - consolidated_footnotes
        - consolidated_equity_statement
        - consolidated_balance_sheet
        - consolidated_cash_flow_statement
        - consolidated_profit_and_loss_statement
        - consolidated_equity_statement
        - consolidated_financial_statement
        - activity_report
        - consolidated_and_parent_activity_report
        - parent_activity_report
        - report_on_payments
        - consolidated_report_on_payments
        - resolution_on_approval
        - consolidated_resolution_on_approval
        - resolution_on_profit_distribution
      example: financial_statement
      x-tags:
        - types
    language:
      type: string
      title: language
      example: pl
      pattern: '^[a-z]{2}$'
      minLength: 2
      maxLength: 2
      description: |-
        Język, w którym sporządzono dokument

        Łańcuch znaków (dwuliterowy kod języka ISO 639-1)
      x-tags:
        - types
    mime_type:
      title: mime_type
      type: string
      description: |-
        Typ MIME pliku.

        [Zobacz listę możliwości](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types)
      x-tags:
        - types

  #-------------------------------
  # Reusable responses
  #-------------------------------
  responses:
    bad_request:
      description: Niewłaściwy format zapytania
      content:
        application/json:
          schema:
            $ref: ../common/models/error.v1.yaml
          examples:
            example-1:
              value:
                error: Invalid year format
    unauthorized:
      description: Niepoprawna autentykacja tokenu
      content:
        application/json:
          schema:
            $ref: ../common/models/error.v1.yaml
          examples:
            example-1:
              value:
                error: "Missing 'Authorization' header"
    forbidden:
      description: Nieudana autoryzacja dostępu do API
      content:
        application/json:
          schema:
            $ref: ../common/models/error.v1.yaml
          examples:
            example-1:
              value:
                error: Access forbidden
    too_many_requests:
      description: Wykorzystany limit zapytań do API
      content:
        application/json:
          schema:
            $ref: ../common/models/error.v1.yaml
          examples:
            example-1:
              value:
                error: Quota is exceeded

  securitySchemes:
    api_key:
      name: Authorization
      type: apiKey
      in: header
      description: |-
        Do uwierzytelniania użytkowników API wykorzystywany jest klucz użytkownika
        przekazywany w nagłówku HTTP `Authorization` przy wywoływaniu poszczególnych metod.
